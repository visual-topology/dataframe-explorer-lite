<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">

    <link href="//fonts.googleapis.com/css?family=Raleway:400,300,600" rel="stylesheet" type="text/css">

    <link href="../../../skadi/lib/exo/exo.css" rel="stylesheet" type="text/css">
    <link href="../../../skadi/lib/exo/exo-icons.css" rel="stylesheet" type="text/css">
    <script src="../../../skadi/lib/exo/exo.js" type="text/javascript"></script>

    <script src="../../../skadi/skadi-page.js" type="text/javascript"></script>
    <link href="https://cdn.datatables.net/2.1.8/css/dataTables.dataTables.css" rel="stylesheet" type="text/css">
    <script src="https://code.jquery.com/jquery-3.7.1.js" type="text/javascript"></script>
    <script src="https://cdn.datatables.net/2.1.8/js/dataTables.js" type="text/javascript"></script>
    <script>
        var dataset = undefined;
        var columns = undefined;

        function clean_nulls(dataset) {
            for(let r=0; r<dataset.length; r +=1) {
                let row = dataset[r];
                for(let c=0; c<row.length; c +=1) {
                    if (row[c] === null || row[c] === undefined) {
                        row[c] = "";
                    }
                }
            }
        }

        function render_table() {
            let elt = document.getElementById("table_container");
            elt.innerHTML = "<table id=\"table_content\" class=\"display\" width=\"100%\"></table>";
            if (dataset && columns) {
                let cols = [];
                for(let idx=0; idx<columns.length; idx++) {
                    cols.push({"title":columns[idx]});
                }
                new DataTable('#table_content', {
                    order: [],
                    columns: cols,
                    data: dataset
                });
            }
        }

        skadi.page.set_message_handler((msg) => {
            if ("data" in msg) {
                dataset = msg.data;
                clean_nulls(dataset);
                columns = msg.columns;
            } else {
                dataset = undefined;
                columns = undefined;
            }
            render_table();
        });

        window.addEventListener("resize",(evt) => {
            render_table();
        });
</script>
</head>
<body>
    <div id="table_container">
    </div>
</div>
</body>
</html>